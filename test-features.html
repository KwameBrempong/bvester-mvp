<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Feature Flags - Bvester</title>
  <style>
    body {
      font-family: -apple-system, sans-serif;
      max-width: 1000px;
      margin: 50px auto;
      padding: 20px;
      background: #0A0A0A;
      color: #fff;
    }
    .card {
      background: #1a1a1a;
      border-radius: 15px;
      padding: 30px;
      margin: 20px 0;
      border: 2px solid #D4AF37;
    }
    h1 {
      color: #D4AF37;
      margin-bottom: 30px;
      text-align: center;
    }
    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }
    .feature-item {
      padding: 20px;
      background: #2a2a2a;
      border-radius: 10px;
      border: 1px solid #444;
      transition: all 0.3s ease;
    }
    .feature-item:hover {
      border-color: #D4AF37;
      transform: translateY(-2px);
    }
    .status {
      display: inline-block;
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 12px;
      font-weight: bold;
      margin-left: 10px;
    }
    .enabled {
      background: #D4AF37;
      color: #000;
    }
    .disabled {
      background: #666;
      color: #fff;
    }
    .btn {
      background: linear-gradient(135deg, #D4AF37, #FFD700);
      color: #000;
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      margin: 10px;
      transition: all 0.3s ease;
    }
    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(212, 175, 55, 0.3);
    }
    .btn-secondary {
      background: transparent;
      border: 2px solid #D4AF37;
      color: #D4AF37;
    }
    .btn-secondary:hover {
      background: #D4AF37;
      color: #000;
    }
    .test-results {
      margin-top: 30px;
      padding: 20px;
      background: #1a1a1a;
      border-radius: 10px;
      border-left: 4px solid #D4AF37;
    }
    .test-item {
      padding: 10px 0;
      border-bottom: 1px solid #333;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .test-item:last-child {
      border-bottom: none;
    }
    .success-icon {
      color: #4CAF50;
      font-size: 20px;
    }
    .error-icon {
      color: #f44336;
      font-size: 20px;
    }
    .warning-icon {
      color: #FF9800;
      font-size: 20px;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>üéØ Bvester Feature Flags Testing</h1>

    <div class="feature-grid">
      <div class="feature-item">
        <h3>üé® Premium Theme</h3>
        <p>Black/Gold/White color scheme</p>
        <span class="status" id="theme-status">Checking...</span>
      </div>

      <div class="feature-item">
        <h3>üîç Investment X-Ray</h3>
        <p>7-minute assessment tool</p>
        <span class="status" id="xray-status">Checking...</span>
      </div>

      <div class="feature-item">
        <h3>üöÄ 30-Day Bootcamp</h3>
        <p>Investment readiness program</p>
        <span class="status" id="bootcamp-status">Checking...</span>
      </div>

      <div class="feature-item">
        <h3>üìä Enhanced Dashboard</h3>
        <p>New analytics features</p>
        <span class="status" id="dashboard-status">Checking...</span>
      </div>
    </div>

    <div style="text-align: center; margin: 30px 0;">
      <button class="btn" onclick="enableAllFeatures()">
        Enable All Features
      </button>
      <button class="btn btn-secondary" onclick="disableAllFeatures()">
        Disable All Features
      </button>
      <button class="btn btn-secondary" onclick="testFeatures()">
        Run Tests
      </button>
    </div>

    <div class="test-results" id="test-results" style="display: none;">
      <h3 style="color: #D4AF37; margin-bottom: 20px;">Test Results</h3>
      <div id="test-content"></div>
    </div>
  </div>

  <script>
    const features = {
      usePremiumTheme: 'theme-status',
      useInvestmentXRay: 'xray-status',
      use30DayBootcamp: 'bootcamp-status',
      useEnhancedDashboard: 'dashboard-status'
    };

    function checkFeatureFlags() {
      try {
        const flags = localStorage.getItem('featureFlags');
        if (!flags) {
          Object.values(features).forEach(id => {
            const elem = document.getElementById(id);
            elem.textContent = 'DISABLED';
            elem.className = 'status disabled';
          });
          return;
        }

        const parsed = JSON.parse(flags);
        Object.entries(features).forEach(([key, id]) => {
          const elem = document.getElementById(id);
          const isEnabled = parsed[key] === true;
          elem.textContent = isEnabled ? 'ENABLED' : 'DISABLED';
          elem.className = `status ${isEnabled ? 'enabled' : 'disabled'}`;
        });
      } catch (error) {
        console.error('Error checking features:', error);
      }
    }

    function enableAllFeatures() {
      const allFeatures = {
        usePremiumTheme: true,
        useInvestmentXRay: true,
        use30DayBootcamp: true,
        useEnhancedDashboard: true,
        useAdvancedAnalytics: true,
        useRealTimeNotifications: true,
        useAIInsights: true,
        useCollaborationTools: true
      };

      localStorage.setItem('featureFlags', JSON.stringify(allFeatures));
      checkFeatureFlags();

      // Show success message
      alert('‚úÖ All features enabled! Refresh the main app to see changes.');
    }

    function disableAllFeatures() {
      const allFeatures = {
        usePremiumTheme: false,
        useInvestmentXRay: false,
        use30DayBootcamp: false,
        useEnhancedDashboard: false,
        useAdvancedAnalytics: false,
        useRealTimeNotifications: false,
        useAIInsights: false,
        useCollaborationTools: false
      };

      localStorage.setItem('featureFlags', JSON.stringify(allFeatures));
      checkFeatureFlags();

      // Show success message
      alert('‚úÖ All features disabled! Refresh the main app to see changes.');
    }

    async function testFeatures() {
      const resultsDiv = document.getElementById('test-results');
      const contentDiv = document.getElementById('test-content');
      resultsDiv.style.display = 'block';
      contentDiv.innerHTML = '';

      const tests = [
        {
          name: 'LocalStorage Access',
          test: () => {
            localStorage.setItem('test', 'value');
            const result = localStorage.getItem('test') === 'value';
            localStorage.removeItem('test');
            return result;
          }
        },
        {
          name: 'Feature Flags Storage',
          test: () => {
            const flags = localStorage.getItem('featureFlags');
            return flags !== null;
          }
        },
        {
          name: 'Premium Theme CSS Loaded',
          test: async () => {
            try {
              const response = await fetch('http://localhost:5175/src/styles/premium-theme.css');
              return response.ok;
            } catch {
              return false;
            }
          }
        },
        {
          name: 'App Server Running',
          test: async () => {
            try {
              const response = await fetch('http://localhost:5175', { mode: 'no-cors' });
              return true;
            } catch {
              return false;
            }
          }
        },
        {
          name: 'Theme Toggle Working',
          test: () => {
            const flags = JSON.parse(localStorage.getItem('featureFlags') || '{}');
            flags.usePremiumTheme = !flags.usePremiumTheme;
            localStorage.setItem('featureFlags', JSON.stringify(flags));
            const newFlags = JSON.parse(localStorage.getItem('featureFlags'));
            const result = newFlags.usePremiumTheme === flags.usePremiumTheme;
            // Restore original state
            flags.usePremiumTheme = !flags.usePremiumTheme;
            localStorage.setItem('featureFlags', JSON.stringify(flags));
            return result;
          }
        }
      ];

      for (const test of tests) {
        const result = await test.test();
        const testItem = document.createElement('div');
        testItem.className = 'test-item';
        testItem.innerHTML = `
          <span>${test.name}</span>
          <span class="${result ? 'success-icon' : 'error-icon'}">
            ${result ? '‚úÖ' : '‚ùå'}
          </span>
        `;
        contentDiv.appendChild(testItem);
      }

      // Add summary
      const summary = document.createElement('div');
      summary.style.marginTop = '20px';
      summary.style.padding = '15px';
      summary.style.background = '#2a2a2a';
      summary.style.borderRadius = '10px';
      summary.style.textAlign = 'center';

      const passedTests = contentDiv.querySelectorAll('.success-icon').length;
      const totalTests = tests.length;

      summary.innerHTML = `
        <h4 style="color: #D4AF37; margin: 0 0 10px 0;">Test Summary</h4>
        <p style="margin: 0; font-size: 18px;">
          ${passedTests}/${totalTests} tests passed
        </p>
      `;
      contentDiv.appendChild(summary);
    }

    // Check on load
    checkFeatureFlags();

    // Auto-refresh every 2 seconds
    setInterval(checkFeatureFlags, 2000);
  </script>
</body>
</html>